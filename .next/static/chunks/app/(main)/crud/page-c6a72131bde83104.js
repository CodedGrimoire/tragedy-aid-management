(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[325],{35550:function(e,t,r){Promise.resolve().then(r.bind(r,22148))},22148:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n}});var a=r(84048),i=r(36397);function n(){let[e,t]=(0,i.useState)([]),[r,n]=(0,i.useState)(null),[s,l]=(0,i.useState)({}),[d,c]=(0,i.useState)(""),[o,m]=(0,i.useState)([]),[h,u]=(0,i.useState)([]);(0,i.useEffect)(()=>{fetch("/api/crud").then(e=>e.json()).then(e=>t(e)).catch(e=>console.error("Error fetching victims:",e)),fetch("/api/events").then(e=>e.json()).then(e=>m(e)).catch(e=>console.error("Error fetching events:",e)),fetch("/api/tragedies").then(e=>e.json()).then(e=>u(e)).catch(e=>console.error("Error fetching tragedies:",e))},[]);let v=async r=>{if(confirm("Are you sure you want to delete this victim?"))try{(await fetch("/api/crud",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({birthCertificateNumber:r})})).ok?(t(e.filter(e=>e.birthCertificateNumber!==r)),alert("Victim deleted successfully.")):alert("Error deleting victim.")}catch(e){console.error("Error deleting victim:",e)}},b=e=>{var t,r,a,i,s,d,c,o,m;n(e.birthCertificateNumber),l({name:e.name,status:e.status||"",medicalID:e.medicalID||"",eventID:e.eventID||"",eventDescription:(null===(t=e.event)||void 0===t?void 0:t.description)||"",eventLocation:(null===(r=e.event)||void 0===r?void 0:r.location)||"",familyID:e.familyID||"",familyHead:(null===(a=e.family)||void 0===a?void 0:a.headName)||"",tragedyID:(null===(d=e.tragedyVictims)||void 0===d?void 0:null===(s=d[0])||void 0===s?void 0:null===(i=s.tragedy)||void 0===i?void 0:i.tragedyID)||"",tragedyName:(null===(m=e.tragedyVictims)||void 0===m?void 0:null===(o=m[0])||void 0===o?void 0:null===(c=o.tragedy)||void 0===c?void 0:c.tragedyName)||""})},p=e=>{l({...s,[e.target.name]:e.target.value})},N=async r=>{try{let a=await fetch("/api/crud",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({birthCertificateNumber:r,...s})});if(a.ok){let i=await a.json();t(e.map(e=>e.birthCertificateNumber===r?i:e)),n(null),alert("Victim updated successfully.")}else alert("Error updating victim.")}catch(e){console.error("Error updating victim:",e)}},g=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase()));return(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Victim Management"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by Name...",value:d,onChange:e=>c(e.target.value),className:"border p-2 mb-4 w-full"}),(0,a.jsxs)("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100",children:[(0,a.jsx)("th",{className:"border p-2",children:"Birth Certificate No."}),(0,a.jsx)("th",{className:"border p-2",children:"Name"}),(0,a.jsx)("th",{className:"border p-2",children:"Status"}),(0,a.jsx)("th",{className:"border p-2",children:"Event"}),(0,a.jsx)("th",{className:"border p-2",children:"Event Location"}),(0,a.jsx)("th",{className:"border p-2",children:"Tragedy"}),(0,a.jsx)("th",{className:"border p-2",children:"Family Head"}),(0,a.jsx)("th",{className:"border p-2",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:g.map(e=>{var t,i,l,d,c,m;return(0,a.jsxs)("tr",{className:"border",children:[(0,a.jsx)("td",{className:"border p-2",children:e.birthCertificateNumber}),(0,a.jsx)("td",{className:"border p-2",children:e.name}),(0,a.jsx)("td",{className:"border p-2",children:r===e.birthCertificateNumber?(0,a.jsx)("select",{name:"status",value:s.status,onChange:p,className:"border p-1",children:["Missing","Deceased","Injured","Found","Unknown"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))}):e.status}),(0,a.jsx)("td",{className:"border p-2",children:r===e.birthCertificateNumber?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("select",{name:"eventID",value:s.eventID,onChange:p,className:"border p-1",children:[(0,a.jsx)("option",{value:"",children:"Select Existing Event"}),o.map(e=>(0,a.jsx)("option",{value:e.eventID,children:e.description},e.eventID))]}),(0,a.jsx)("input",{name:"eventDescription",placeholder:"Or enter new event",value:s.eventDescription,onChange:p,className:"border p-1 mt-1"})]}):null===(t=e.event)||void 0===t?void 0:t.description}),(0,a.jsx)("td",{className:"border p-2",children:r===e.birthCertificateNumber?(0,a.jsx)("input",{name:"eventLocation",value:s.eventLocation,onChange:p,className:"border p-1"}):null===(i=e.event)||void 0===i?void 0:i.location}),(0,a.jsx)("td",{className:"border p-2",children:r===e.birthCertificateNumber?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("select",{name:"tragedyID",value:s.tragedyID,onChange:p,className:"border p-1",children:[(0,a.jsx)("option",{value:"",children:"Select Existing Tragedy"}),h.map(e=>(0,a.jsx)("option",{value:e.tragedyID,children:e.tragedyName},e.tragedyID))]}),(0,a.jsx)("input",{name:"tragedyName",placeholder:"Or enter new tragedy",value:s.tragedyName,onChange:p,className:"border p-1 mt-1"})]}):null===(c=e.tragedyVictims)||void 0===c?void 0:null===(d=c[0])||void 0===d?void 0:null===(l=d.tragedy)||void 0===l?void 0:l.tragedyName}),(0,a.jsx)("td",{className:"border p-2",children:r===e.birthCertificateNumber?(0,a.jsx)("input",{name:"familyHead",value:s.familyHead,onChange:p,className:"border p-1"}):null===(m=e.family)||void 0===m?void 0:m.headName}),(0,a.jsx)("td",{className:"border p-2",children:r===e.birthCertificateNumber?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>N(e.birthCertificateNumber),className:"bg-blue-500 text-white px-2 py-1 rounded mr-2",children:"Save"}),(0,a.jsx)("button",{onClick:()=>n(null),className:"bg-gray-500 text-white px-2 py-1 rounded",children:"Cancel"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>b(e),className:"bg-yellow-500 text-white px-2 py-1 rounded mr-2",children:"Modify"}),(0,a.jsx)("button",{onClick:()=>v(e.birthCertificateNumber),className:"bg-red-600 text-white px-2 py-1 rounded",children:"Delete"})]})})]},e.birthCertificateNumber)})})]})]})}}},function(e){e.O(0,[510,342,744],function(){return e(e.s=35550)}),_N_E=e.O()}]);