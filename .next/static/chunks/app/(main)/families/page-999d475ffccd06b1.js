(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[160],{41405:function(e,t,s){Promise.resolve().then(s.bind(s,27080))},27080:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(84048),r=s(36397),i=s(64914),n=s(20410),l=s(32120),o=s(69338),d=s(87625),p=s(23333);let c=["#e63946","#457b9d"];function m(){let[e,t]=(0,r.useState)([]),[s,m]=(0,r.useState)([]),[u,h]=(0,r.useState)({}),[x,y]=(0,r.useState)({}),[f,b]=(0,r.useState)(!0),[g,j]=(0,r.useState)({}),[N,v]=(0,r.useState)({supportType:"",amount:""}),[w,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{D()},[]);let D=async()=>{b(!0);try{let e=await fetch("/api/families");if(!e.ok)throw Error("Failed to fetch families");let s=await e.json();t(s.families),m(s.familySupportOptions),h(s.stats)}catch(e){console.error("Error fetching families:",e)}finally{b(!1)}},C=async e=>{if(x[e]){j({...g,[e]:!0});try{if(!(await fetch("/api/families",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({familyID:e,supportID:x[e]})})).ok)throw Error("Failed to assign support");await D()}catch(e){console.error("Error assigning support:",e)}finally{j({...g,[e]:!1})}}},I=async()=>{if(N.supportType&&N.amount){S(!0);try{if(!(await fetch("/api/families",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)})).ok)throw Error("Failed to add support");v({supportType:"",amount:""}),await D()}catch(e){console.error("Error adding support:",e)}finally{S(!1)}}};return f?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-red-200 border-t-red-600 rounded-full animate-spin"})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Families Dashboard"}),(0,a.jsx)(i.h,{width:"100%",height:300,children:(0,a.jsxs)(n.u,{children:[(0,a.jsx)(l.b,{data:[{name:"Recipients",value:u.recipientsCount},{name:"Non-Recipients",value:u.nonRecipientsCount}],dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:90,label:!0,children:c.map((e,t)=>(0,a.jsx)(o.b,{fill:e},t))}),(0,a.jsx)(d.u,{}),(0,a.jsx)(p.D,{})]})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mt-6 mb-4",children:"Family List"}),e.map(e=>(0,a.jsxs)("div",{className:"bg-white shadow-md p-4 rounded-md my-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["#",e.familyID," - ",e.headName]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Contact: ",e.contact]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Address: ",e.address]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Victims: ",e.victims.length]}),e.receivedSupport?(0,a.jsxs)("p",{className:"text-green-600",children:["Support Received (ID: ",e.supportID,") âœ…"]}):(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("label",{className:"text-gray-700",children:"Assign Support:"}),(0,a.jsxs)("select",{className:"ml-2 px-3 py-2 border rounded-md",value:x[e.familyID]||"",onChange:t=>y({...x,[e.familyID]:parseInt(t.target.value)}),children:[(0,a.jsx)("option",{value:"",children:"Select Support"}),s.map(e=>(0,a.jsxs)("option",{value:e.supportID,children:[e.supportType," ($",e.amount,")"]},e.supportID))]}),(0,a.jsx)("button",{onClick:()=>C(e.familyID),disabled:g[e.familyID],className:"ml-2 px-4 py-2 rounded-md bg-red-600 text-white hover:bg-blue-700 transition-colors",children:g[e.familyID]?"Assigning...":"Assign"})]})]},e.familyID)),(0,a.jsx)("h2",{className:"text-2xl font-semibold mt-6",children:"Add New Family Support"}),(0,a.jsxs)("div",{className:"mt-4 bg-white p-4 shadow-md rounded-md",children:[(0,a.jsx)("input",{type:"text",placeholder:"Support Type",value:N.supportType,onChange:e=>v({...N,supportType:e.target.value}),className:"border p-2 mr-2 rounded-md"}),(0,a.jsx)("input",{type:"number",placeholder:"Amount",value:N.amount,onChange:e=>v({...N,amount:parseFloat(e.target.value)}),className:"border p-2 mr-2 rounded-md"}),(0,a.jsx)("button",{onClick:I,disabled:w,className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-green-700 transition-colors",children:w?"Adding...":"Add Support"})]})]})})}}},function(e){e.O(0,[682,410,510,342,744],function(){return e(e.s=41405)}),_N_E=e.O()}]);