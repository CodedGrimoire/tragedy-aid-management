(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[725],{4202:function(e,i,t){Promise.resolve().then(t.bind(t,71688))},71688:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return m}});var s=t(84048),a=t(36397),n=t(64914),r=t(20410),d=t(32120),l=t(69338),o=t(87625),c=t(23333);let u=["#e63946","#457b9d"];function m(){let[e,i]=(0,a.useState)([]),[t,m]=(0,a.useState)([]),[b,h]=(0,a.useState)({}),[y,x]=(0,a.useState)({}),[p,g]=(0,a.useState)(!0),[f,N]=(0,a.useState)({}),[j,v]=(0,a.useState)({medicalCondition:"",amount:"",eligibility:""}),[C,S]=(0,a.useState)(!1);(0,a.useEffect)(()=>{w()},[]);let w=async()=>{g(!0);try{let e=await fetch("/api/gsubsidy");if(!e.ok)throw Error("Failed to fetch victims");let t=await e.json();i(t.victims),m(t.subsidyOptions),h(t.stats)}catch(e){console.error("Error fetching victims:",e)}finally{g(!1)}},E=async e=>{if(y[e]){N({...f,[e]:!0});try{if(!(await fetch("/api/gsubsidy",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({birthCertificateNumber:e,subsidyID:y[e]})})).ok)throw Error("Failed to assign subsidy");await w()}catch(e){console.error("Error assigning subsidy:",e)}finally{N({...f,[e]:!1})}}},k=async()=>{if(j.medicalCondition&&j.amount&&j.eligibility){S(!0);try{if(!(await fetch("/api/gsubsidy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).ok)throw Error("Failed to add subsidy");v({medicalCondition:"",amount:"",eligibility:""}),await w()}catch(e){console.error("Error adding subsidy:",e)}finally{S(!1)}}};return p?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-red-200 border-t-red-600 rounded-full animate-spin"})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Victim Subsidy Dashboard"}),(0,s.jsx)(n.h,{width:"100%",height:300,children:(0,s.jsxs)(r.u,{children:[(0,s.jsx)(d.b,{data:[{name:"Subsidy Recipients",value:b.recipientsCount},{name:"Non-Recipients",value:b.nonRecipientsCount}],dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:90,label:!0,children:u.map((e,i)=>(0,s.jsx)(l.b,{fill:e},i))}),(0,s.jsx)(o.u,{}),(0,s.jsx)(c.D,{})]})}),(0,s.jsx)("h2",{className:"text-2xl font-semibold mt-6",children:"Victim List"}),e.map(e=>(0,s.jsxs)("div",{className:"bg-white shadow-md p-4 rounded-md my-4",children:[(0,s.jsxs)("h2",{className:"text-xl",children:[e.name," (#",e.birthCertificateNumber,")"]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Subsidy: ",e.receivedSubsidy?"✅ (ID: ".concat(e.subsidyID,")"):"❌ No Subsidy"]}),!e.receivedSubsidy&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("label",{className:"text-gray-700",children:"Assign Subsidy:"}),(0,s.jsxs)("select",{className:"ml-2 px-3 py-2 border rounded-md",value:y[e.birthCertificateNumber]||"",onChange:i=>x({...y,[e.birthCertificateNumber]:parseInt(i.target.value)}),children:[(0,s.jsx)("option",{value:"",children:"Select Subsidy"}),t.map(e=>(0,s.jsxs)("option",{value:e.subsidyID,children:[e.medicalCondition," ($",e.amount,")"]},e.subsidyID))]}),(0,s.jsx)("button",{onClick:()=>E(e.birthCertificateNumber),disabled:f[e.birthCertificateNumber],className:"ml-2 px-4 py-2 rounded-md bg-red-600 text-white hover:bg-blue-700 transition-colors",children:f[e.birthCertificateNumber]?"Assigning...":"Assign"})]})]},e.birthCertificateNumber)),(0,s.jsx)("h2",{className:"text-2xl font-semibold mt-6",children:"Add New Subsidy"}),(0,s.jsxs)("div",{className:"mt-4 bg-white p-4 shadow-md rounded-md",children:[(0,s.jsx)("input",{type:"text",placeholder:"Medical Condition",value:j.medicalCondition,onChange:e=>v({...j,medicalCondition:e.target.value}),className:"border p-2 mr-2 rounded-md"}),(0,s.jsx)("input",{type:"number",placeholder:"Amount",value:j.amount,onChange:e=>v({...j,amount:parseFloat(e.target.value)}),className:"border p-2 mr-2 rounded-md"}),(0,s.jsx)("input",{type:"text",placeholder:"Eligibility",value:j.eligibility,onChange:e=>v({...j,eligibility:e.target.value}),className:"border p-2 mr-2 rounded-md"}),(0,s.jsx)("button",{onClick:k,disabled:C,className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-green-700 transition-colors",children:C?"Adding...":"Add Subsidy"})]})]})})}}},function(e){e.O(0,[682,410,510,342,744],function(){return e(e.s=4202)}),_N_E=e.O()}]);