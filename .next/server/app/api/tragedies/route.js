"use strict";(()=>{var e={};e.id=7008,e.ids=[7008],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},99969:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{DELETE:()=>c,GET:()=>d,POST:()=>p});var i=r(36126),n=r(69184),s=r(36197),o=r(30482);async function d(){try{let e=await o.Z.tragedy.findMany({include:{tragedyVictims:{include:{victim:{select:{birthCertificateNumber:!0,eventID:!0}}}}}}),t=await Promise.all(e.map(async e=>{let t={},r={};for(let{victim:a}of e.tragedyVictims)if(a.eventID){t[a.eventID]=(t[a.eventID]||0)+1;let e=await o.Z.event.findUnique({where:{eventID:a.eventID},select:{description:!0}});r[a.eventID]=e?.description||"No description available"}return{tragedyID:e.tragedyID,tragedyName:e.tragedyName,totalVictims:e.tragedyVictims.length,eventVictimData:Object.entries(t).map(([e,t])=>({eventID:parseInt(e),victims:t,description:r[e]}))}}));return new Response(JSON.stringify(t),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("GET /api/tragedies error:",e),new Response(JSON.stringify({error:"Failed to fetch tragedies."}),{status:500,headers:{"Content-Type":"application/json"}})}}async function p(e){try{let{tragedyName:t}=await e.json(),r=await o.Z.tragedy.create({data:{tragedyName:t}});return new Response(JSON.stringify(r),{status:201,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("POST /api/tragedies error:",e),new Response(JSON.stringify({error:"Failed to create tragedy."}),{status:500,headers:{"Content-Type":"application/json"}})}}async function c(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("tragedyID"));if(!r)return new Response(JSON.stringify({error:"Tragedy ID is required."}),{status:400,headers:{"Content-Type":"application/json"}});return await o.Z.tragedyVictim.deleteMany({where:{tragedyID:r}}),await o.Z.tragedy.delete({where:{tragedyID:r}}),new Response(JSON.stringify({message:"Tragedy deleted successfully."}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("DELETE /api/tragedies error:",e),new Response(JSON.stringify({error:"Failed to delete tragedy."}),{status:500,headers:{"Content-Type":"application/json"}})}}let u=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/tragedies/route",pathname:"/api/tragedies",filename:"route",bundlePath:"app/api/tragedies/route"},resolvedPagePath:"/Users/tazkia/Desktop/Uddhar/app/api/tragedies/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:g,serverHooks:y}=u,m="/api/tragedies/route";function h(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},30482:(e,t,r)=>{r.d(t,{Z:()=>a});let a=new(r(53524)).PrismaClient},36126:(e,t,r)=>{e.exports=r(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9576],()=>r(99969));module.exports=a})();