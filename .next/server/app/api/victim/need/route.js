"use strict";(()=>{var e={};e.id=2037,e.ids=[2037],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63706:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>v});var i={};r.r(i),r.d(i,{GET:()=>d,POST:()=>p});var n=r(36126),s=r(69184),a=r(36197),o=r(53524),u=r(81602);let c=new o.PrismaClient;async function d(e){try{let{searchParams:t}=new URL(e.url),r=t.get("victimID"),i=t.get("needType"),n=t.get("urgencyLevel"),s=t.get("status"),a=t.get("startDate"),o=t.get("endDate"),d={};(a||o)&&(d={...a&&{gte:new Date(a)},...o&&{lte:new Date(o)}});let p={where:{...r&&{birthCertificateNumber:parseInt(r)},...i&&{needType:{contains:i,mode:"insensitive"}},...n&&{urgencyLevel:n},...s&&{status:s},...Object.keys(d).length>0&&{dateIdentified:d}},include:{victim:{select:{name:!0,status:!0,gender:!0,event:{select:{description:!0,location:!0}}}}},orderBy:[{urgencyLevel:"desc"},{dateIdentified:"desc"}]},l=await c.VictimNeed.findMany(p);return u.NextResponse.json(l)}catch(e){return console.error("Error fetching victim needs:",e),u.NextResponse.json({error:"Failed to fetch victim needs",details:e.message},{status:500})}}async function p(e){try{let{birthCertificateNumber:t,needType:r,urgencyLevel:i,notes:n}=await e.json();if(!t||!r||!i)return u.NextResponse.json({error:"Missing required fields"},{status:400});if(isNaN(parseInt(t)))return u.NextResponse.json({error:"Invalid victim ID"},{status:400});if(!["high","medium","low"].includes(i.toLowerCase()))return u.NextResponse.json({error:"Urgency level must be high, medium, or low"},{status:400});if(!await c.Victim.findUnique({where:{birthCertificateNumber:parseInt(t)}}))return u.NextResponse.json({error:"Victim not found"},{status:404});let s=await c.VictimNeed.create({data:{birthCertificateNumber:parseInt(t),needType:r,urgencyLevel:i.toLowerCase(),status:"pending",...n&&{notes:n}},include:{victim:{select:{name:!0,status:!0}}}});return u.NextResponse.json(s,{status:201})}catch(e){return console.error("Error creating victim need:",e),u.NextResponse.json({error:"Failed to create victim need",details:e.message},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/victim/need/route",pathname:"/api/victim/need",filename:"route",bundlePath:"app/api/victim/need/route"},resolvedPagePath:"/Users/tazkia/Desktop/Uddhar/app/api/victim/need/route.js",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:g}=l,h="/api/victim/need/route";function f(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:v})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[9576,4946],()=>r(63706));module.exports=i})();