"use strict";(()=>{var e={};e.id=5769,e.ids=[5769],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92933:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>y,patchFetch:()=>m,requestAsyncStorage:()=>f,routeModule:()=>u,serverHooks:()=>c,staticGenerationAsyncStorage:()=>d});var r={};i.r(r),i.d(r,{GET:()=>p,POST:()=>l});var n=i(36126),s=i(69184),a=i(36197),o=i(30482);async function p(e){try{let e=await o.Z.familyInfo.findMany();if(!e||0===e.length)return new Response(JSON.stringify({error:"No families found"}),{status:404,headers:{"Content-Type":"application/json"}});return new Response(JSON.stringify(e),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("GET /api/families error:",e),new Response(JSON.stringify({error:"Failed to fetch families."}),{status:500,headers:{"Content-Type":"application/json"}})}}async function l(e){try{let t=await e.json();if(!t)return new Response(JSON.stringify({error:"Request body is missing"}),{status:400,headers:{"Content-Type":"application/json"}});let{headName:i,contact:r,address:n}=t;if(!i)return new Response(JSON.stringify({error:"Head name is required"}),{status:400,headers:{"Content-Type":"application/json"}});let s=await o.Z.familyInfo.findFirst({where:{AND:[{headName:i},r?{contact:r}:{},n?{address:n}:{}]}});if(s)return new Response(JSON.stringify({message:"A family with this information already exists. Using existing record.",family:s,isExisting:!0}),{status:200,headers:{"Content-Type":"application/json"}});let a=await o.Z.familyInfo.create({data:{headName:i,contact:r,address:n}});return new Response(JSON.stringify({message:"Family record created successfully",family:a,isExisting:!1}),{status:201,headers:{"Content-Type":"application/json"}})}catch(e){if(console.error("POST /api/families error:",e),"P2002"===e.code)return new Response(JSON.stringify({error:"A family with this information already exists.",details:"Please try again with different information or use the search function to find the existing record."}),{status:409,headers:{"Content-Type":"application/json"}});return new Response(JSON.stringify({error:"Failed to create family.",details:e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}let u=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/family/route",pathname:"/api/family",filename:"route",bundlePath:"app/api/family/route"},resolvedPagePath:"/Users/tazkia/Desktop/Uddhar/app/api/family/route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:d,serverHooks:c}=u,y="/api/family/route";function m(){return(0,a.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:d})}},30482:(e,t,i)=>{i.d(t,{Z:()=>r});let r=new(i(53524)).PrismaClient},36126:(e,t,i)=>{e.exports=i(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[9576],()=>i(92933));module.exports=r})();