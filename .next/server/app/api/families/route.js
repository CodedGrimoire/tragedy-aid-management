"use strict";(()=>{var e={};e.id=8875,e.ids=[8875],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},73261:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{GET:()=>u,PATCH:()=>c,POST:()=>l});var a=r(36126),i=r(69184),n=r(36197),o=r(81602);let p=new(r(53524)).PrismaClient;async function u(e){try{let e=await p.familyInfo.findMany({include:{recipient:!0,victims:!0}}),t=await p.familySupport.findMany(),r=e.length,s=e.filter(e=>e.recipient).length,a=e.map(e=>({familyID:e.familyID,headName:e.headName,contact:e.contact,address:e.address,receivedSupport:!!e.recipient,supportID:e.recipient?e.recipient.supportID:null,victims:e.victims}));return o.NextResponse.json({families:a,familySupportOptions:t,stats:{totalFamilies:r,recipientsCount:s,nonRecipientsCount:r-s}},{status:200})}catch(e){return console.error("Error fetching families:",e),o.NextResponse.json({error:e.message},{status:500})}}async function c(e){try{let{familyID:t,supportID:r}=await e.json(),s=await p.familyInfo.findUnique({where:{familyID:t},include:{recipient:!0}});if(!s)return o.NextResponse.json({error:"Family not found"},{status:404});if(s.recipient)return o.NextResponse.json({error:"Family already has support"},{status:400});let a=await p.recipient.create({data:{familyID:t,supportID:r,dateReceived:new Date}});return o.NextResponse.json({message:"Family support assigned successfully",recipient:a},{status:201})}catch(e){return console.error("Error assigning FamilySupport:",e),o.NextResponse.json({error:e.message},{status:500})}}async function l(e){try{let{supportType:t,amount:r}=await e.json();if(!t||!r)return o.NextResponse.json({error:"Missing fields"},{status:400});let s=await p.familySupport.create({data:{supportType:t,amount:r}});return o.NextResponse.json({message:"Support created",support:s},{status:201})}catch(e){return console.error("Error adding FamilySupport:",e),o.NextResponse.json({error:e.message},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/families/route",pathname:"/api/families",filename:"route",bundlePath:"app/api/families/route"},resolvedPagePath:"/Users/tazkia/Desktop/Uddhar/app/api/families/route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:y}=d,g="/api/families/route";function h(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9576,4946],()=>r(73261));module.exports=s})();