(()=>{var e={};e.id=2160,e.ids=[2160],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},22736:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>c,originalPathname:()=>m,pages:()=>p,routeModule:()=>u,tree:()=>d}),a(72472),a(36104),a(80867),a(5607);var s=a(44257),r=a(69184),i=a(42259),n=a.n(i),o=a(70057),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(t,l);let d=["",{children:["(main)",{children:["families",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,72472)),"/Users/tazkia/Desktop/Uddhar/app/(main)/families/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,36104)),"/Users/tazkia/Desktop/Uddhar/app/(main)/layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,80867,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,49810))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,5607)),"/Users/tazkia/Desktop/Uddhar/app/layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,80867,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,49810))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],p=["/Users/tazkia/Desktop/Uddhar/app/(main)/families/page.js"],m="/(main)/families/page",c={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(main)/families/page",pathname:"/families",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},20770:(e,t,a)=>{Promise.resolve().then(a.bind(a,25036))},25036:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(24495),r=a(33247),i=a(11835),n=a(66418),o=a(8392),l=a(84699),d=a(9645),p=a(91057);let m=["#e63946","#457b9d"];function c(){let[e,t]=(0,r.useState)([]),[a,c]=(0,r.useState)([]),[u,h]=(0,r.useState)({}),[x,f]=(0,r.useState)({}),[y,g]=(0,r.useState)(!0),[b,j]=(0,r.useState)({}),[v,w]=(0,r.useState)({supportType:"",amount:""}),[N,P]=(0,r.useState)(!1),S=async()=>{g(!0);try{let e=await fetch("/api/families");if(!e.ok)throw Error("Failed to fetch families");let a=await e.json();t(a.families),c(a.familySupportOptions),h(a.stats)}catch(e){console.error("Error fetching families:",e)}finally{g(!1)}},D=async e=>{if(x[e]){j({...b,[e]:!0});try{if(!(await fetch("/api/families",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({familyID:e,supportID:x[e]})})).ok)throw Error("Failed to assign support");await S()}catch(e){console.error("Error assigning support:",e)}finally{j({...b,[e]:!1})}}},k=async()=>{if(v.supportType&&v.amount){P(!0);try{if(!(await fetch("/api/families",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})).ok)throw Error("Failed to add support");w({supportType:"",amount:""}),await S()}catch(e){console.error("Error adding support:",e)}finally{P(!1)}}};return y?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"w-16 h-16 border-4 border-red-200 border-t-red-600 rounded-full animate-spin"})}):s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Families Dashboard"}),s.jsx(i.h,{width:"100%",height:300,children:(0,s.jsxs)(n.u,{children:[s.jsx(o.b,{data:[{name:"Recipients",value:u.recipientsCount},{name:"Non-Recipients",value:u.nonRecipientsCount}],dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:90,label:!0,children:m.map((e,t)=>s.jsx(l.b,{fill:e},t))}),s.jsx(d.u,{}),s.jsx(p.D,{})]})}),s.jsx("h2",{className:"text-2xl font-semibold mt-6 mb-4",children:"Family List"}),e.map(e=>(0,s.jsxs)("div",{className:"bg-white shadow-md p-4 rounded-md my-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["#",e.familyID," - ",e.headName]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Contact: ",e.contact]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Address: ",e.address]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Victims: ",e.victims.length]}),e.receivedSupport?(0,s.jsxs)("p",{className:"text-green-600",children:["Support Received (ID: ",e.supportID,") âœ…"]}):(0,s.jsxs)("div",{className:"mt-2",children:[s.jsx("label",{className:"text-gray-700",children:"Assign Support:"}),(0,s.jsxs)("select",{className:"ml-2 px-3 py-2 border rounded-md",value:x[e.familyID]||"",onChange:t=>f({...x,[e.familyID]:parseInt(t.target.value)}),children:[s.jsx("option",{value:"",children:"Select Support"}),a.map(e=>(0,s.jsxs)("option",{value:e.supportID,children:[e.supportType," ($",e.amount,")"]},e.supportID))]}),s.jsx("button",{onClick:()=>D(e.familyID),disabled:b[e.familyID],className:"ml-2 px-4 py-2 rounded-md bg-red-600 text-white hover:bg-blue-700 transition-colors",children:b[e.familyID]?"Assigning...":"Assign"})]})]},e.familyID)),s.jsx("h2",{className:"text-2xl font-semibold mt-6",children:"Add New Family Support"}),(0,s.jsxs)("div",{className:"mt-4 bg-white p-4 shadow-md rounded-md",children:[s.jsx("input",{type:"text",placeholder:"Support Type",value:v.supportType,onChange:e=>w({...v,supportType:e.target.value}),className:"border p-2 mr-2 rounded-md"}),s.jsx("input",{type:"number",placeholder:"Amount",value:v.amount,onChange:e=>w({...v,amount:parseFloat(e.target.value)}),className:"border p-2 mr-2 rounded-md"}),s.jsx("button",{onClick:k,disabled:N,className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-green-700 transition-colors",children:N?"Adding...":"Add Support"})]})]})})}},72472:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(19670).createProxy)(String.raw`/Users/tazkia/Desktop/Uddhar/app/(main)/families/page.js#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[9576,6846,8755,4504,3424,6418,8482],()=>a(22736));module.exports=s})();